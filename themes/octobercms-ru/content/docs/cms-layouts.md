# Шаблоны ( Layouts )

- [ Введение](#introduction)
- [ Плейсхолдеры](#placeholders)
- [ Динамические макеты](#dynamic-layouts)

В шаблонах определяются разметка верхних (header) и нижних (footer) участков страниц. В основном, шаблоны содержат HTML, HEAD, TITLE и BODY.

## <a name="introduction" class="anchor" href="#introduction"></a> Введение

Шаблоны находятся в корне папки темы, в поддиректории **/layouts**. Имеют расширение **htm**. Внутри файла шаблона имеется тег `{% page %}`, выводящий содержимое страницы. Пример простого макета:

    <html>
        <body>
            {% page %}
        </body>
    </html>

Чтобы использовать шаблон, в [странице](cms-pages.md) должно быть указано его название (без расширения), в секции [Конфигурации](cms-themes.md#configuration-section), значением параметра layout:

    url = "/"
    layout = "default"
    ==
    <p>Привет, Мир!</p>
    
>Необходимо помнить, что при хранении шаблона в [поддиректории](cms-themes.md#subdirectories) нужно указывать полный путь **subdirectory/layout**

При вызове этой страницы в браузере, отобразится содержимое шаблона, при этом тег `{% page %}` заменится содержимым этой страницы, и, если разметка была осуществлена как указано выше, выведется:

    <html>
        <body>
            <p>Привет, Мир!</p>
        </body>
    </html>

Следует обратить внимание на создание [чанков](cms-partials.md) и использование их в шаблонах. Это позволяет использовать одинаковую разметку в разных шаблонах, что даёт возможность редактировать эти участки не перебирая каждый шаблон. Как пример, использование стилей CSS и привязка JavaScript файлов.

Секция [Конфигурации](cms-themes.md#configuration-section) является необязательным для шаблонов. В ней используются такие параметры как **name** и **description**. Эти параметры необязательны и нужны лишь для интерфейса административной части. Пример конфигурации шаблона с параметром его описания:

    description = "Простой пример шаблона"
    ==
    <html>
        <body>
            {% page %}
        </body>
    </html>

## <a name="placeholders" class="anchor" href="#placeholders"></a> Плейсхолдеры

Плейсхолдеры дают возможность использовать какой угодно код в содержимом страниц, в определённом заранее месте их шаблона, тегом `{% placeholder name %}`:

    <html>
        <head>
            {% placeholder head %}
        </head>
        ...

Страницы, использующие шаблон выше, могут вводить в эти места код посредствам тегов `{% put %}` и `{% endput %}` следующим образом:

    url = "/my-page"
    layout = "default"
    ==
    {% put head %}
        <link href="/themes/demo/assets/css/page.css" rel="stylesheet">
    {% endput %}

    <p>Какое- то содержание страницы.</p>

Плейсхолдеры могут быть определены значением по умолчанию, которое может переопределяться или дополняться в содержимом страниц:

    {% placeholder sidebar default %}
        <p><a href="/contacts">Контакты</a></p>
    {% endplaceholder %}

Как говорилось выше, значение по умолчанию можно дополнять при помощи тега `{% default %}`:

    {% put sidebar %}
        <p><a href="/services">Сервис</a></p>
        {% default %}
    {% endput %}
    
Если не указать этот тег, значение по умолчанию будет заменено.

### <a name="checking-placeholder-exits" class="anchor" href="#checking-placeholder-exits"></a> Проверка плейсхолдера на странице

В шаблоне можно использовать проверку на указание в содержимом страницы в плейсхолдер за счёт функции `placeholder()`, что позволяет добиться какой угодно разметки, в зависимости от того, что указано в содержимом страниц:

    {% if placeholder('sidemenu') %}
        <!-- Разметка страниц использующих боковое меню -->
        <div class="row">
            <div class="col-md-3">
                {% placeholder sidemenu %}
            </div>
            <div class="col-md-9">
                {% page %}
            </div>
        </div>
    {% else %}
        <!-- Разметка страниц не использующих боковое меню -->
        {% page %}
    {% endif %}

## <a name="dynamic-layouts" class="anchor" href="#dynamic-layouts"></a> Динамичность шаблонов

Шаблоны, как и страницы, могут использовать любые возможсности Twig ( [Динамичность страниц](cms-pages.md#dynamic-pages) ). В шаблонах указываются [PHP секции](themes#php-section) которые могут выполняться в определённые циклы загрузки страницы, за счёт функций: `onStart()`, `onBeforePageStart()` и `onEnd()`. 

Функция `onStart()` выполняется в самом начале обработки страницы. 

`onBeforePageStart()` выполняется после того как запустятся [компоненты](components), но перед функцией `onStart()`. 

`onEnd()` запускается после обработки страницы. 

Последовательность обработки выполняется в следующем порядке:

1. `onStart()` функция шаблона
2. `onRun()` метод компонент шаблона
3. `onBeforePageStart()` функция шаблона
4. `onStart()` функция страницы
5. `onRun()` метод компонент страницы
6. `onEnd()` функция страницы
7. `onEnd()` функция шаблона

